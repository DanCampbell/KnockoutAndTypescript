
@{
    ViewBag.Title = "Points Ticker";
}

<h2>PointsTicker</h2>
<div>
    <div>
        <canvas id="canvas" height="450" width="600"></canvas>
    </div>
</div>

<div>
   
        <ul class="list-group" data-bind="foreach:Points().slice(0).reverse()">
            <li class="list-group-item">
                <Span data-bind="text:Name"></Span>
                <Span data-bind="text:Message"></Span>
                </li>
        </ul>

</div>
<link href="~/Content/bootstrap.css" rel="stylesheet" />

<script src="~/Scripts/knockout-3.4.2.js"></script>
<script src="~/Scripts/knockout.mapping-latest.js"></script>
<script src="~/Scripts/PointsTicker.js"></script>
<script src="~/Scripts/knockout.validation.js"></script>
<script src="~/Scripts/Chart.js"></script>

@section scripts {
    <script src="~/Scripts/jquery.signalR-2.2.2.min.js"></script>

    <!--Reference the autogenerated SignalR hub script. -->
    <script src="~/signalr/hubs"></script>
    <script>
        $(function () {
            @*var jsModel2 = @Html.Raw(Json.Encode(Model));*@
            var chat = $.connection.kidHub;
           
            var viewModel = new PointTickerViewModel();
            var ctx = document.getElementById('canvas').getContext('2d');
           // debugger;

        //    console.log(jsModel2);
            @*var viewmodel = { children: ko.mapping.fromJS(@Html.Raw(Json.Encode(Model))) };*@

            ko.validation.init({
                registerExtenders: true,

                messagesOnModified: true,

                insertMessages: true

            });
            viewModel.ChatVar = chat;
            viewModel.context = ctx;
            ko.applyBindings(viewModel);
            chat.client.addNewMessageToPage = function (name, message) {
                // Add the message to the page.
                viewModel.updateTicker(name, message);
               
            };
            viewModel.initLine();
            $.connection.hub.start();

        });
    </script>
}